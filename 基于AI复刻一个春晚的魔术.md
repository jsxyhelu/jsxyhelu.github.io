# 基于AI复刻一个春晚的魔术

今年春晚中出现了一个使用计算器的魔术，进一步研究发现相关原理还是比较简单的，所以想基于AI开展复刻。

## 一、基本情况

### 🎭 魔术基本信息
- **魔术名称**：《惊喜定格》
- **表演者**：魔术师邓男子，与尼格买提、希林娜依·高合作表演
- **表演时间**：2026年马年央视春晚

### ✨ 魔术内容
表演过程中，邓男子邀请现场观众随机报出数字，引导大家操作手机计算器共同"生成"新的数字。当所有数字相加完毕后，计算器屏幕显示出" 2162227 "，这串数字对应着当下的这一刻： **2月16日22点27分** （春晚直播的精准时刻）。

邓男子在表演结束时说："希望屏幕前的观众，每一位都能够定住惊喜，每一天都能把握住当下的幸福。"

### 🔍 魔术原理揭秘
这个魔术看似神奇，实则背后有精巧的设计：

1. **真实互动**：前两轮观众报数是真实的、随机的，增强了表演的可信度
2. **特制道具**：魔术师使用的是特制手机，其计算器内置提前编写好的程序，并非普通手机计算器
3. **数学原理**：
   - a. 程序已经设定好终极目标2162227
   - b. 只需要用目标值减去前两轮的"锚点总和"，得到一个固定值
   - c. 魔术师输入这个固定值，最终显示预设的结果
4. **精准卡点**：22:27的精准卡点是节目组经过无数次彩排、精准测算每段流程时长后定下的直播节点，确保按下等号的瞬间，时钟恰好定格在22:27

当然，魔术的关键在于现场表演，不过对于做工程的来说，我更关注的是如何复刻，这里基于trae+GLM4.7开展。

## 二、探索过程

### 2.1 首先尝试并且放弃了原生APP的形式
首先想实现的是基于AndroidStudio来完成，因为不仅是这个程序，我同时希望能够恢复相关工作堆，但是目前还是由于相关基础库的下载比较麻烦（无法自动执行），所以放弃了。这里反过来说，手机APP程序在目前仍然是有护城河的，但是我瞄了一眼，适合androidStudio也开似乎能够AI生成了。

### 2.2 替换采用webAPP的形式
转换思路，实现一个web程序（这个AI最为擅长），而后托管到网络上。这样无论是网页还是手机，都可以访问。特别是APP形式，可以尽可能模仿相关效果。

让我没有想到的是，在看是最容易实现的"计算器"这个程序的实现过程中也经历了反复，比如一开始界面就很奇怪：

而后，在反复和大模型对话的过程中，找到关键的部分：
①参考春晚魔术的细节；
②只要计算结果大于目标值，就触发魔术效果

此外，由于Doubao-seed-2.0-code是多模态模型，所以可以直接截图一张windows自带的计算器截图让其参考实现。

### 2.3 替换采用webAPP的形式

#### 1. 界面设计与实现
- **布局结构**：使用HTML构建了标准计算器的布局，包括标题栏、显示区域、记忆按钮区和数字/功能按钮区
- **样式设计**：使用CSS实现了米黄色背景、白色数字按钮和灰色功能按钮的设计风格
- **响应式适配**：添加了媒体查询，确保在手机等小屏幕设备上也能正常显示
- **宽度调整**：将计算器宽度从320px增加到400px，确保显示完整的时间格式

#### 2. 核心功能实现
- **基础计算功能**：实现了加减乘除四则运算
- **高级功能**：添加了百分比、倒数、平方、立方根等高级数学运算
- **记忆功能**：实现了MC、MR、M+、M-、MS、M±等记忆操作
- **清除功能**：支持C、CE和退格键操作

#### 3. 魔术效果设计
- **时间获取**：实现了 getCurrentTime() 方法，获取并格式化当前时间为 YYYYMMDDHHMM 格式
- **魔术模式**：默认开启魔术模式，当计算结果大于当前时间时触发魔术效果
- **状态管理**：使用 magicMode 变量控制魔术模式的开启与关闭
- **显示优化**：确保魔术模式下时间格式完整显示，不转换为科学计数法

#### 4. 技术难点与解决方案
- **连续运算处理**：修改了 setOperator 方法，确保连续运算时正确累积结果
- **魔术触发时机**：通过比较计算结果与当前时间，实现了精确的魔术效果触发
- **显示问题**：解决了长数字显示的科学计数法转换问题
- **用户体验**：确保输入过程中显示正常，只有在最终结果时触发魔术效果

#### 5. 前端技术栈
- **HTML5**：构建语义化的页面结构
- **CSS3**：实现响应式布局和美观的视觉效果
- **JavaScript (ES6+)**：使用类和现代语法实现计算器逻辑

#### 6. 核心算法
- **计算逻辑**：实现了完整的算术运算和高级数学函数
- **时间比较**：使用 parseFloat() 将时间字符串转换为数字进行比较
- **状态管理**：通过类变量管理计算器的各种状态

#### 7. 性能优化
- **事件委托**：使用事件监听器处理按钮点击事件
- **显示限制**：对长数字进行适当处理，确保显示清晰
- **延迟加载**：优化了计算和显示的时机，提升用户体验

## 三、小结

①在AI时代，护城河仍然是有了，比如这里在手机端的编写就是需要额外做工作的，但是创意是最大的护城河；

②现有的和未来的工具确实会极大地提高工作效率，及时产出才能产生价值；

③目前web的形式在最终效果上肯定还有所欠缺，这是原生 APP不可替代的地方；

④doubaoseed相比较glm4.7是具备多模态的，这个是这次才了解到的

最终结果：

开源地址：

---

**原文链接**：https://www.modelscope.cn/learn/5643